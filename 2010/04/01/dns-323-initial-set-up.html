<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="chrome=1">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1">
<link rel=stylesheet href=/blog.css>
<link rel="shortcut icon" href=/favicon.ico type=image/x-icon>
<title>
DNS-323: Initial set-up &ndash; ebullient·works
</title>
<link rel=canonical href=/2010/04/01/dns-323-initial-set-up.html>
</head>
<body>
<div class=wrapper>
<header class=page-header>
<h1><a href=/>ebullient·works</a></h1>
<div>
[ <a href=/about/>About</a> &#183; <a href=/archive/>Archive</a> &#183; <a href=/tags/>Tags</a> ]
</div>
</header>
<main class=page id=content>
<article class=post>
<header>
<h1>DNS-323: Initial set-up</h1>
</header>
<section class=content>
<p>I purchased (a shamefully long time ago, welcome to tech live as a mom with a toddler) a DNS-323 (and two 1T drives) with the hope of moving most of our shared files onto it. Now that we don't record TV shows anymore, having that box on all the time is just a power drain. So: the goal is a DNS-323 with all of our files (photos, music, finance stuff, some movies, etc.) onto the first volume of that drive, and then using an rsync shadow with hardlinks to do nightly backups to the second drive. Some RAID configurations have been reported as less than stable, and using a mirror configuration requires both drives to be active: a nightly rsync backup will do.
</p>
<h3>Applying firmware and extra software</h3>
<p>
A <a href="http://www.dlink.com/products/default.aspx?pid=DNS-323&tab=3">firmware update</a> became available between when I bought the unit and when I finally got a chance to work on it-- so I updated the firmware to 1.08, and installed the optional NFS package, though I haven't set NFS up yet.
</p><blockquote>
Firmware
<ol>
<li>Download the firmware update (as a zip) from dlink.com (under "Support Resources")</li>
<li>Unzip the download</li>
<li>Using the Web UI, go to the Tools tab, select Firmware from the left-hand menu</li>
<li>Use the browse button to find the firmware update (dns323_firmware_108 in my case)</li>
<li>Use the apply button (which is in the text above the form, oddly enough) to apply the firmware update</li>
</ol>
Additional Software / NFS update
<ol>
<li>Download the additional software package from dlink.com (under "Additional Downloads")</li>
<li>Unzip the download</li>
<li>Using the Web UI, go to the Advanced tab, and select "ADD-ONS"</li>
<li>Browse to the unzipped file using the appropriate form (Application Pack, in my case, with the file dns323_NFS _Package_v1.00)</li>
<li>Use the apply button to install the software: it will show up in the table below (in the case of the application pack, anyway), and you can toggle the status there (enable/disable via start/stop).</li>
</ol>
</blockquote>
<h3>Setting up funplug, etc.</h3>
<p>
First, install <a href=http://www.inreto.de/dns323/fun-plug/0.5/>fun_plug (v0.5)</a>.
<ul>
<li>I used the Web UI to create a new user, and then used the FTP to transfer fun_plug and fun_plug.tgz to Volume 1 as described <a href=http://wiki.dns323.info/howto:fun_plug>here</a>.</li>
<li>Easy to follow instructions to install additional packages from in the <a href=http://www.inreto.de/dns323/fun-plug/0.5/README.txt>README</a>: <blockquote>
<pre>telnet &lt;your-dns-323&gt;
cd /mnt/HD_a2
rsync -av inreto.de::dns323/fun-plug/0.5/packages .
cd packages
funpkg -i *.tgz
</pre></blockquote> That does install all of the additional packages, but <a href=http://wiki.dns323.info/howto:ffp#version_0.5>fonz's how-to</a> recommends, <blockquote><p>There's nothing in the install tarball (fun_plug.tgz) that's not in a package. The simplest way to stay current is to install all the main packages ( http://www.inreto.de/dns323/fun-plug/0.5/packages/ ).</p><p>I suggest to keep a local copy of the packages using rsync (don't forget –delete). Then use 'funpkg -i *.tgz' and 'funpkg -u *.tgz' to install and upgrade. </p></blockquote>So, that's what I did. At the end of the day, I'll be using quite a few of the extra packages anyhow... </li>
</ul>
All of the above was easy enough, and gave me a telnet shell with root access (no password).
</p>
<h4>Fixing the root user</h4>
<p><a href=http://wiki.dns323.info/howto:ffp#version_0.5>fonz's how-to</a> includes a section on "fixing" the root user.
<table>
<tr><td>pwconv</td><td>Ensures we have an /etc/shadow file based on the contents of /etc/passwd</td></tr>
<tr><td>passwd</td><td>Set a password for root</td></tr>
<tr><td>usermod -s /ffp/bin/sh root</td><td>Set the root user's shell to one that won't prompt for an obscure unlock code</td></tr>
<tr><td>pwck</td><td>Sanity check the /etc/passwd file; ignore missing home directories for nobody and admin</td></tr>
<tr><td>grpck</td><td>Sanity check the /etc/group file; ignore bad group names 500/501</td></tr>
<tr><td>login</td><td>Test your changes: verify you can log in with the password you think you set. ;) </td></tr>
</table>
</section>
<footer class=byline>
<div>posted <time class=post_date>01 April 2010</time></div>
<div class=tags>tags:
<ul><li>&nbsp;<a href=/tags/#backup>backup</a></li><li>&nbsp;<a href=/tags/#hardware-nas>hardware-nas</a></li></ul>
</div>
</footer>
</article>
<nav class=prev-next>
<div class=nav-left><a href=/2010/04/01/movies-schmovies.html title="Previous: Movies schmovies">&#171; Older</a></div>
<div class=nav-center><a href=/>Top</a> | <a href=/archive/>Archive</a></div>
<div class=nav-right><a href=/2010/05/16/dns-323-finally-back-to-it-sshbusybox.html title="Next: DNS-323: Finally back to it (SSH/busybox)">Newer &#187;</a></div>
</nav>
</main>
</div>
<footer class=page-footer>
<div id=copyrights>&#169; 2002-2023 Erin Schnabel</div>
<div class=icons>
<a target=_blank rel=nopopener href=https://github.com/ebullient title="ebullient on GitHub"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</a>
<a target=_blank rel="me nopopener" href=https://fosstodon.org/@ebullient title="Follow @ebullient"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48.0.0.0-63.72 28.5-63.72 125.7.0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54.0 01-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
</a>
<a target=_blank rel=nopopener href=https://twitter.com/ebullientworks title="Follow @ebullientworks"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</a>
<a target=_blank rel=nopopener href=https://www.linkedin.com/in/erinschnabel/ title="Erin Schnabel on linked.in"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1.0 83.5.0 53.8a53.79 53.79.0 01107.58.0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29.0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"/></svg>
</a>
<a target=_blank rel=nopopener href=/index.xml title=Subscribe><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328.0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765.0 183.105.0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686.0 38.981.0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"/></svg> </a>
</div>
</footer>
</body>
</html>