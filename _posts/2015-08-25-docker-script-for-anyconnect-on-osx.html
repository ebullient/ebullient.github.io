---
layout: post
title: Docker script for AnyConnect on OSX
redirect_from:
- articles/72/docker-script-for-anyconnect-on-osx
tags:
- docker
- mac
- vpn
- scripts
---
	<p>I am queen of laziness, and I have to use AnyConnect, and that screws with Docker, and then I have to go looking to remember the magic incantation to get things right&#8230;</p>

	<p>Who has time for that? </p>

	<p>I made a script that wraps the whole thing up and reminds me what I should do when it doesn&#8217;t work.</p>

	<p>Instead of: <br />
<pre>&gt; docker-machine env default</pre><br />
I do this instead, and the script does the rest: <br />
<pre>&gt; . dockerEnv</pre></p>
<!--more-->
	<p>The contents of the script are pretty trivial (I am sure shell wizards can find plenty  wrong with it, starting with the direct reference to bash, but whatever. Laziness, right?): </p>

<pre class="bigblock"><code>#!/bin/bash
</code>
<code>UP=`docker-machine status default`
if [ &quot;$UP&quot; != &quot;Running&quot; ] ; then
   echo &quot;Starting default docker VM&quot;
   docker-machine start default
fi
</code>
<code>eval &quot;$(docker-machine env default)&quot;
export DM_IP=$(docker-machine ip default)
echo $DM_IP
</code>
<code>DM_SUBNET=192.168.$(echo $DM_IP| cut -d&#39;.&#39; -f 3)
</code>
<code>RESULT=`netstat -rn | grep $DM_SUBNET | grep vboxnet`
if [ &quot;$RESULT&quot; = &quot;&quot; ] ; then
    echo &quot;Adding route for vboxnet0&quot;
    sudo route -nv add -net $DM_SUBNET -interface vboxnet0
</code>
<code>    RESULT=`netstat -rn | grep $DM_SUBNET | grep vboxnet`
    if [ $RESULT = &quot;&quot; ] ; then
    	echo &quot;Quit AnyConnect and re-run this script.&quot;
        exit
    fi
fi
</code>
<code>docker-machine ls
</code></pre>

	<p class="small">[edit on 3 Sept: updated for even better-ness. Laziness rocks.]</p>
