<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=stylesheet href=/blog.css><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><title>thinkpad</title><link rel=canonical href=/tags/thinkpad.html><link rel=alternate type=application/rss+xml href=/tags/thinkpad/index.xml title=ebullient·works></head><body><div class=wrapper><header class=page-header><h1><a href=/>ebullient·works</a></h1><div>[ <a href=/about/>About</a> &#183; <a href=/archive/>Archive</a> ]</div></header><h1>Posts</h1><article><h2>lubuntu 11.04 on a thinkpad w520</h2><p>Getting ready to do some travelling for work (Hooray for people that <a href=http://wasdev.net>love our alpha</a>!), and figured I should move things from my much beloved purple Dell (which is the quadcore I got when I needed one), to the Lenovo Thinkpad W520 that is my official business issued laptop.</p><p>My dell is running straight-up ubuntu, with gnome modified to start fluxbox as its window manager (You have to understand that I *love* fluxbox-- you have to twiddle to get the themes so you like it, but if you're <a href=http://fluxbox.org/features/>addicted to tabs</a>, as I am, you're done). But.. that was kind of the "install everything and gradually remove what you don't want" approach. So, with the new shiny, I've opted for something in between the bare metal I started with when I was running gentoo, and the fully loaded ubuntu: <a href=https://help.ubuntu.com/community/Lubuntu>lubuntu</a>.</p><p>Lubuntu is small, stil ubuntu based (and I do like ubuntu-- gentoo was fun, but I have a toddler now.. and not nearly as much time left for figuring out why my system/tools don't work), and quite honestly, the devs did a great job of smoothing the experience of using something isn't gnome- or kde-centered.</p><p>The first thing I did was swap openbox with fluxbox (painlessly!). I'm now focused more on getting my data transferred to the new box. I'll post more as I start fussing with settings.</p><p>Good things to note:<ul><li>Stuff just worked. No huge show stop issues (and this with a W520). Granted, I didn't ask for trouble: I'm using the 32bit version of lubuntu natty--this thinkpad model is newer than the LTS release.</li><li>I am (thankfully) not the first to <a href=http://www.thinkwiki.org/wiki/Installing_Ubuntu_11.04_on_a_ThinkPad_W520>get ubuntu working on this model of thinkpad</a>.</li></ul></p></article><article><h2>Fixing ATI again..</h2><p>I'm also rebuilding my T60p in place (meaning I started half of it while chrooted, and have now switched over to the newer half...).</p><p>I've run into a new issue loading the dri drivers: AIGLX error: dlopen of /usr/lib/dri/fglrx_dri.so failed (/usr/lib/dri/fglrx_dri.so: undefined symbol: __glXFindDRIScreen). Moving to the latest ati driver seemed to fix that (8.37.6-r1).</p><ul><li><a href=http://xoomer.alice.it/flavio.stanchina/debian/fglrx-installer.html#configure>ATI Linux drivers for debian</a> has great information around how to configure X11 to work with the proprietary ati drivers.</li><li><a href=http://www.thinkwiki.org/wiki/Fglrx>Fglrx - ThinkWiki</a> is a good source for how this stuff all works with thinkpads...</li></ul></article><article><h2>Gentoo and an IBM T60p - Part 2: Dual Boot / NTFS</h2><p>I have what I tried below, but I eventually dropped the attempt. The Lenovo modules hung up <span class=caps>VMW</span>are any time I tried to boot it that way, and while I could mount the <span class=caps>NTFS</span> partition used by WinXP R/W with the tools below, I could not easily get WinXP to look at the lion's share of the drive. (My fault, really – if I weren't so attached to other filesystem types, I could probably have made this work).</p><h3>Dual Boot</h3><p>My new-fangled laptop comes with XP Pro, and I don't have disks for re-installing that OS from scratch (in <span class=caps>VMW</span>are, for example). So, as an experiment, I decided to resize the WinXP partition, and put gentoo on the lion's share of the drive. I want to see if I can get a dual-boot OR <span class=caps>VMW</span>are image running off of that same base – because I think that would be cool<sup id=fnrev7048958234fd685f22dbf8 class=footnote><a href=#fn7048958234fd685f22dbf8>1</a></sup>. File access would be interesting – but that's another story; I want to see if it will work, first. As part of that effort, I also added support for R/W <span class=caps>NTFS</span><sup id=fnrev422670574fd685f22dc27 class=footnote><a href=#fn422670574fd685f22dc27>2</a></sup>.</p><ul><li>sys-fs/ntfsprogs-1.13.1</li></ul><p>While poking around, I read up on <span class=caps>NTFS</span><sup id=fnrev21372720164fd685f22e6a2 class=footnote><a href=#fn21372720164fd685f22e6a2>3</a></sup> – and I think, based on the interoperability section, that I'll also look into ntfs-3g. Note that this requires the freshest version of fuse, which means: don't compile <span class=caps>CONFIG</span>_FUSE_FS into your kernel. Either compile it as a module, or leave it out entirely.</p><ul><li>sys-fs/fuse-2.6.0</li><li>sys-fs/ntfs3g-0.20061115-r1</li></ul><h3>Footnotes / References :</h3><p id=fn7048958234fd685f22dbf8 class=footnote><sup>1</sup> <a href=http://www.geocities.com/epark/linux/grub-w2k-HOWTO.html>Dual-boot with Grub</a> <span class=attribute>[<a href=http://www.geocities.com/epark/linux/>geocities.com/epark/linux/</a>]</span> , and <a href=http://news.u32.net/articles/2006/07/18/running-vmware-on-a-physical-partition>Running <span class=caps>VMW</span>are on a Physical Partition</a></p><p id=fn422670574fd685f22dc27 class=footnote><sup>2</sup> <a href=http://gentoo-wiki.com/HOWTO_NTFS_write_with_ntfsmount><span class=caps>HOWTO</span> <span class=caps>NTFS</span> write with ntfsmount</a> <span class=attribute>[<a href=http://gentoo-wiki.com/>gentoo-wiki.com</a>]</span></p><p id=fn21372720164fd685f22e6a2 class=footnote><sup>3</sup> <a href=http://en.wikipedia.org/wiki/NTFS><span class=caps>NTFS</span></a> :wiki:</p></article><article><h2>Gentoo and an IBM T60p - Part 3: Networking</h2><p>Getting networking up and running on the T60p has been a mixed bag. On one hand, the wired connection was easy (expected). The wireless was at first <span class=caps>REALLY</span> flaky, then after some fiddling the connection at home (<span class=caps>WEP</span>) was functional, and as of now (when I'm finally posting this thing) it still doesn't work at work (<span class=caps>LEAP</span>).</p><h3>Wired connection</h3><p>I set the wired connection (using e1000 module) up with netplug so that it will figure out when the cable is and isn't there – it has the added bonus of scheduling net-dependent services at startup.</p><ul><li>sys-apps/netplug-1.2.9-r3</li></ul><h3>Wireless</h3><p>For whatever reason, this laptop does not have an Intel wireless chipset. The Atheros AR5212<sup id=fnrev11129864324fd685eb57840 class=footnote><a href=#fn11129864324fd685eb57840>1</a></sup> that it does have requires the <code>madwifi</code> driver.</p><p>I also need <span class=caps>WEP</span> and <span class=caps>LEAP</span>, so I use wpa_supplicant as well.</p><ul><li>net-wireless/wireless-tools-28</li><li>net-wireless/ieee80211-1.1.13-r1</li><li>net-wireless/madwifi-ng-0.9.2.1</li><li>net-wireless/madwifi-ng-tools-0.9.2</li><li>net-wireless/wpa_supplicant-0.5.4</li></ul><p>At first, wpa_supplicant would drop the connection after a few minutes. I couldn't find anything conclusive about why this was happening, but the one thing I did find suggested using the generic interface (wext) with wpa_supplicant rather than madwifi<sup id=fnrev8827124634fd685eb57f89 class=footnote><a href=#fn8827124634fd685eb57f89>2</a></sup>. No change.</p><p>When at home using <span class=caps>WPA</span>, the connection cycled frequently (sometimes as frequently as once every 4 or 5 minutes). When at work trying to use <span class=caps>LEAP</span>, it wouldn't correctly establish a connection at all. :sigh:</p><p>I think I was suffering from a known bug<sup id=fnrev18397749934fd685eb583ab class=footnote><a href=#fn18397749934fd685eb583ab>3</a></sup>, so I created some new ebuilds for the 1605 version of madwifi-ng. That seems to have improved the resilience of the connection considerably.</p><p>I <strong>still</strong> am having trouble with rotating through connections and associating via <span class=caps>LEAP</span> at work. I have been using ap_scan=2 because of hidden <span class=caps>SSID</span>s in the office, the problem is that this forces profiles to be tried in order, and when wpa_cli fails on the first one, it seems not to automagically roll over to the next (which previous versions of wpa_supplicant did just fine.. )</p><p>I've found some evidence<sup id=fnrev13878314054fd685eb5893f class=footnote><a href=#fn13878314054fd685eb5893f>4</a></sup> suggesting that ap_scan=2 won't work because madwifi-ng doesn't support it. Lovely. But! There is hope<sup id=fnrev5177507454fd685eb58989 class=footnote><a href=#fn5177507454fd685eb58989>5</a></sup> a patch was added to the madwifi driver at a later level than the one I had to revert to.</p><p>I haven't retried wireless at work recently. I'll post more when I do.</p><p>— <em>update 2007 Jan 5: madwifi-ng-0.9.2.1 should also include the association fix&#8230; I am now using madwifi-ng-0.9.2.1 (r1842), and that seems to work as well.</em></p><h3>Footnotes / References :</h3><p id=fn11129864324fd685eb57840 class=footnote><sup>1</sup> <a href=http://www.gentoo-wiki.com/HARDWARE_ar5212><span class=caps>HARDWARE</span> (Atheros) ar5212</a> <span class=attribute>[<a href=http://gentoo-wiki.com/>gentoo-wiki.com</a>]</span></p><p id=fn8827124634fd685eb57f89 class=footnote><sup>2</sup> <a href=http://lists.shmoo.com/pipermail/hostap/2006-June/013430.html>wpa_supplicant + madwifi + hidden <span class=caps>SSID</span></a></p><p id=fn18397749934fd685eb583ab class=footnote><sup>3</sup> <a href=http://madwifi.org/ticket/973>ThinkPad Z60t: moving from r1543 to r1757 madwifi stops working at all</a></p><p id=fn13878314054fd685eb5893f class=footnote><sup>4</sup> <a href=http://lists.shmoo.com/pipermail/hostap/2005-March/009669.html>ap_scan=2 problem?</a></p><p id=fn5177507454fd685eb58989 class=footnote><sup>5</sup> <a href=http://madwifi.org/ticket/275>Scan for non-<span class=caps>ESSID</span>-broadcasting access point always fails</a></p><h3>Other References (of course):</h3><ul><li><a href=http://madwifi.org/wiki/UserDocs>MadWifi User Docs</a> <span class=attribute>[<a href=http://madwifi.org>madwifi.org</a>]</span></li><li><a href=http://www.thinkwiki.org/wiki/Installing_Ubuntu_6.06_Flight_6_on_a_ThinkPad_X60s>Ubunto on X60s</a> — ndiswrapper for Atheros</li></ul></article><article><h2>Gentoo and an IBM T60p - Part 1: Installation and X</h2><p>Got a new T60 <strong>yay!</strong>, here's my brain dump on getting it to work with gentoo (2006.1).</p><p>See also (Updated as new parts are added):</p><ul><li><a href=/config/261/GentooandanIBMT60pPart2>Part 2: <span class=caps>NTFS</span></a></li><li><a href=/config/260/GentooandanIBMT60pPart3>Part 3: Networking</a></li></ul><h3>General 'fo:</h3><table><tr><td>Motherboard:</td><td>Lenovo ThinkPad T60 2613EJU<sup id=fnrev21131636054fd685f89dc07 class=footnote><a href=#fn21131636054fd685f89dc07>1</a></sup></td></tr><tr><td>Processor:</td><td>Intel Core Duo T2600 (2.16GHz)<sup id=fnrev15003744444fd685f89de7a class=footnote><a href=#fn15003744444fd685f89de7a>2</a></sup></td></tr><tr><td>Memory:</td><td>2 &#215; 1G DDR2</td></tr><tr><td>Graphics Card:</td><td><span class=caps>ATI</span> Mobility FireGL 256MB</td></tr><tr><td>Hard Drives:</td><td>100GB <span class=caps>SATA</span> 7200RPM</td></tr><tr><td>Sound Card:</td><td>Intel (ICH7) : <span class=caps>ALSA</span> hda-intel<sup id=fnrev16564309884fd685f89e634 class=footnote><a href=#fn16564309884fd685f89e634>3</a></sup></td></tr><tr><td>Wired:</td><td>Intel Corp. 82573L Gigabit</td></tr><tr><td>Wireless:</td><td>Atheros Communications AR5212 <span class=caps>NIC</span></td></tr></table><h3>Installation</h3><p>I followed the general install instructions for gentoo; no rocket science here. I used 2006.1/desktop profile, which sets a lot of handy use flags for you – what you have to do is unset those you don't want (like gnome or kde). In general, I try to keep the global flags list short(er) – though the default desktop profile pulls a lot of stuff in. I prefer setting use flags per package via the /etc/portage/package.use file.</p><blockquote><p>added: acpi directfb dmx fbcon fuse gtk2 hdaps madwifi mmx motif opengl real samba smp sse sse2 svg syslog usb wifi</p></blockquote><blockquote><p>removed: -arts -apm -esd -gnome -ipv6 -kde -ldap -nls</p></blockquote><p><em>Note:</em> <code>euse</code> (from gentoolkit) is very useful here. Using <code>euse -i</code> you can tell: a) all of the packages that make use of a given flag and what they use it for, and b) whether or not it's included or excluded from the default profile or from your make.conf. Handy stuff.</p><p>I adjusted the grub install for Dual-boot, and did some checking for kernel options: a) <span class=caps>ACPI</span> configuration, b) removing <span class=caps>DRM</span> because of the <span class=caps>ATI</span> chipset (below), etc.</p><p>Just for the hell of it, I set up sSMTP to route to my gmail account<sup id=fnrev4313280124fd685f89fc9d class=footnote><a href=#fn4313280124fd685f89fc9d>4</a></sup>.</p><ul><li>sys-kernel/gentoo-sources-2.6.18-r3</li><li><a href=/files/config-2.6.18-gentoo-r3.txt>kernel .config</a></li></ul><h3>Pointing devices:</h3><p>I decided to add drivers for the touchpad (we'll see how long it lasts – I'll probably end up disabling it via the <span class=caps>BIOS</span>..) and for using the mouse on(in? at?) the console. I didn't need to do anything special aside from emerging the packages (and in the case of gpm, starting the daemon via /etc/init.d/gpm).</p><ul><li>x11-drivers/synaptics-0.14.5-r1</li><li>sys-libs/gpm-1.20.1-r5</li></ul><h3>On-Screen Display and Thinkpad things</h3><p>For thinkpad buttons, I use <code>tpb</code> with the <code>xosd</code> use flag to enable on-screen display when you push things (like the volume buttons). After emerging tpb, update <code>/etc/tpbrc</code> per your preferences. Use the <code>hdaps</code> useflag with <code>tm_smapi</code> to enable 1/2 of automatic HD head parking function (the reading-the-data part).</p><p>For on-screen display to work w/ X, you have to start tpb when you start X, and it has to have access to the display, etc.</p><ul><li>x11-libs/xosd-2.2.14-r1</li><li>app-laptop/tpb-0.6.4</li><li>app-laptop/tp_smapi-0.27</li><li>app-laptop/tpctl-4.17</li><li><a href=/files/tpb.sh>script for starting tpb</a></li></ul><h3>Setting up X</h3><p>This is the fun part. As noted above, the T60 uses an <span class=caps>ATI</span> FireGL graphics chipset, which means binary <span class=caps>ATI</span> drivers<sup id=fnrev19985520194fd685f8a126c class=footnote><a href=#fn19985520194fd685f8a126c>5</a></sup>. I grabbed the latest of both <code>ati-drivers</code> and <code>ati-drivers-extra</code> (with <code>~x86</code> for both in /etc/portage/package.keywords). The combination of use flags mentioned above were sufficient for both packages.</p><p><em>Note:</em> <code>ati-drivers-extra-8.30.3</code> required libXinerama when the qt use flag is enabled, even if qt did not use that flag. I had to emerge <code>x11-libs/libXinerama</code> for <code>ati-drivers-extra</code> to compile properly.</p><p>After emerging the package (followed by <code>source /etc/profile</code> to regen path strings), I copied the <code>xorg.conf.example</code> to <code>xorg.conf</code> (in <code>/etc/X11</code>) and used <code>aticonfig --initial --input=/etc/X11/xorg.conf</code> to create an initial xorg.conf file. Then I updated the file to strip down what was in there – keeping the <span class=caps>ATI</span> stuff, and punting the extra stuff.</p><p>Without too much fooling around, X came up (with <span class=caps>DRI</span> and everything). The settings generated by aticonfig left a lot to X11 defaults. 1600&#215;1200 at depth 24:<br><pre><code># xdpyinfo | grep resolution -A 1 -B 1
dimensions: 1600x1200 pixels (301x221 millimeters)
resolution: 135x138 dots per inch
depths (7): 24, 1, 4, 8, 15, 16, 32
</code></pre></p><p>Now, I did check out <code>sys-apps/ddcxinfo-knoppix</code>, and I have to say it's pretty neat. It spat out all kinds of things about the <span class=caps>TFT</span> display. I've included the output in the list below.</p><ul><li>x11-drivers/ati-drivers-8.30.3-r1</li><li>x11-apps/ati-drivers-extra-8.30.3</li><li>x11-base/xorg-x11-7.1</li><li><a href=/files/xorg.conf.t60p>xorg.conf</a></li><li><a href=/files/T60p.ddcxinfo>ddcxinfo-knoppix for T60p <span class=caps>TFT</span> display</a>, <a href=/files/T60p.ddcxinfo.monitor>ddcxinfo-knoppix monitor section</a></li></ul><p>I did see the following message in Xorg.0.log: <code>(EE) AIGLX error: dlopen of /usr/lib/dri/fglrx_dri.so failed (/usr/lib/dri/fglrx_dri.so: cannot open shared object file: No such file or directory)</code>. According to the <a href=http://www.gentoo.org/proj/en/desktop/x/x11/modular-x-howto.xml>Modular X Migration</a> guide:</p><blockquote><p>Note: With modular installed, external drivers such as nvidia-glx and wacom as well as some vnc apps may not work if they install things to <code>/usr/lib/modules</code> instead of <code>/usr/lib/xorg/modules</code>. Many of these will have modular X detection added to the installation process.</p></blockquote><p>The ati-drivers ebuild does have such detection, and the requested library was installed in the new location (<code>/usr/lib/xorg/modules/dri</code>) however, it looks like the code trying to load the <span class=caps>DLL</span> is still expecting it in the old place? I tried the most obvious first.. create a symlink from the new location to the old. That seemed to really open things up.</p><pre><code># glxinfo
direct rendering: Yes
server glx vendor string: SGI
server glx version string: 1.2
...
client glx vendor string: ATI
client glx version string: 1.3
...
OpenGL vendor string: ATI Technologies Inc.
OpenGL renderer string: ATI MOBILITY FireGL V5200 Pentium 4 (SSE2) (FireGL) (GNU_ICD)
OpenGL version string: 2.0.6119 (8.30.3)
</code></pre><p>I still, however, saw an error message: <code>AIGLX error: dlsym for __driCreateNewScreen_20050727 failed (/usr/lib/dri/fglrx_dri.so: undefined symbol: __driCreateNewScreen_20050727</code>. This seems not to harm anything, and the screen is so darn beautiful I just want to use it for awhile.</p><h3>Sound</h3><p>Why not. Sound next. In the kernal config, I enabled support for <span class=caps>ALSA</span> as modules. I enabled Intel HD Audio PCI Driver for the kernel-based hda-intel module. I didn't have to set up any of the dmix stuff I used to, as (I seem to remember reading) that's all built in these days. Everything "appears to function" right out of the box. Goodness!</p><ul><li>media-sound/alsa-utils-1.0.13</li><li>media-libs/alsa-oss-1.0.12</li></ul><h3>Footnotes / References :</h3><p id=fn21131636054fd685f89dc07 class=footnote><sup>1</sup> <a href="http://www-307.ibm.com/pc/support/site.wss/document.do?sitestyle=lenovo&lndocid=MIGR-62487">Overview – ThinkPad T60, T60p</a> <span class=attribute>[<a href=http://www.ibm.com>www.ibm.com</a>]</span></p><p id=fn15003744444fd685f89de7a class=footnote><sup>2</sup> <a href=http://support.intel.com/support/notebook/centrino/duo/>Intel&#174; Centrino&#8482; Duo Mobile Technology</a> <span class=attribute>[<a href=http://www.intel.com>intel.com</a>]</span><br><a href="http://processorfinder.intel.com/details.aspx?sSpec=SL8VN">Intel&#174; Core&#8482; Duo processor T2600</a></p><p id=fn16564309884fd685f89e634 class=footnote><sup>3</sup> <a href="http://www.alsa-project.org/alsa-doc/doc-php/template.php?company=Intel&card=ICH+southbridge+HD-audio+and+modem.&chip=ICH6%2C+ICH6M%2C+ICH7%2C+ESB2&module=hda-intel"><span class=caps>ALSA</span>: hda-intel</a> <span class=attribute>[<a href=http://www.alsa-project.org>alsa-project.org</a>]</span></p><p id=fn4313280124fd685f89fc9d class=footnote><sup>4</sup> <a href=http://gentoo-wiki.com/HOWTO_Gmail_and_sSMTP><span class=caps>HOWTO</span> Gmail and sSMTP</a> <span class=attribute>[<a href=http://gentoo-wiki.com/>gentoo-wiki.com</a>]</span></p><p id=fn19985520194fd685f8a126c class=footnote><sup>5</sup> <a href=http://odin.prohosting.com/wedge01/gentoo-radeon-faq.html#1_whyuse>Gentoo <span class=caps>ATI</span> Radeon <span class=caps>FAQ</span></a> <span class=attribute>[<a href=http://odin.prohosting.com/wedge01/>odin.prohosting.com/wedge01</a>]</span></p><p id=fn6 class=footnote><sup>6</sup> <a href=http://www.mozilla.org/unix/dpi.html>Mozilla Font Size / <span class=caps>DPI</span> Issues</a></p><h3>Other References (of course):</h3><ul><li><a href=http://tuxmobil.org/centrino.html>Linux on Intel&#174; Centrino&#8482; and Centrino-Duo&#8482; Laptops and Notebooks</a> <span class=attribute>[<a href=http://tuxmobil.org/>tuxmobil.org</a>]</span></li><li><a href=http://tuxmobil.org/ibm.html>Linux Laptop and Notebook Installation Survey: <span class=caps>IBM</span>/Lenovo</a> <span class=attribute>[<a href=http://tuxmobil.org/>tuxmobil.org</a>]</span></li></ul><ul><li><a href=http://www.hardwareinreview.com/cms/content/view/49>Lenovo ThinkPad T60p review</a> <span class=attribute>[<a href=http://www.hardwareinreview.com>hardwareinreview.com</a>]</span></li><li><a href=http://thinkwiki.org/wiki/Category:T60p>Category:T60p</a> <span class=attribute>[<a href=http://thinkwiki.org/>thinkwiki.org</a>]</span></li><li><a href="http://zachtib.com/?p=19">The new Thinkpad T60p</a> <span class=attribute>[<a href=http://zachtib.com>zachtib.com</a>]</span></li><li><a href=http://buzzy.tesuji.org/thinkpad_t60p.html>Gentoo Linux on the Thinkpad T60p</a></li><li><a href=http://www.thinkwiki.org/wiki/Installation_instructions_for_the_ThinkPad_T60p>Installation instructions for the ThinkPad T60p</a> <span class=attribute>[<a href=http://www.thinkwiki.org>thinkwiki.org</a>]</span></li><li><a href=http://www.thinkwiki.org/wiki/HDAPS><span class=caps>HDAPS</span></a> <span class=attribute>[<a href=http://www.thinkwiki.org>thinkwiki.org</a>]</span><ul><li><a href=http://www.thinkwiki.org/wiki/How_to_protect_the_harddisk_through_APS>How to protect the harddisk through <span class=caps>APS</span></a></li></ul></li><li><a href=http://gentoo-wiki.com/HOWTO_ALSA_sound_mixer_aka_dmix title="Complete, include sound mixer"><span class=caps>HOWTO</span> Alsa</a> <span class=attribute>[<a href=http://gentoo-wiki.com>gentoo-wiki.com</a>]</span></li><li><a href=http://www.infinitephoto.com/pages/dpi.htm><span class=caps>DPI</span> and File Size calculator/formulas</a> <span class=attribute>[<a href=http://www.infinitephoto.com>www.infinitephoto.com</a>]</span></li></ul><p><em>2007-01-05: Updated to make all linked files work (missed uploading a few), added link to Parts 2 and 3.</em></p></article><article><h2>Gentoo/T40: Nailing down wireless config</h2><p>Gathering some links to get wireless working (better) on my <span class=caps>T40.</span> I'm trying to figure out how to get some semblance of roaming... <strong>sigh</strong></p><p><em>References:</em></p><ul><li><a href=http://gentoo-wiki.com/HOWTO_Wireless_Configuration_and_Startup><span class=caps>HOWTO</span> Wireless Configuration and Startup</a> <span class=attribute>[<a href=http://gentoo-wiki.com>gentoo-wiki.com</a>]</span></li><li><a href="http://www.gentoo.org/doc/en/handbook/handbook-x86.xml?part=4&chap=4">Wireless Networking</a> <span class=attribute>[<a href="http://www.gentoo.org/doc/en/handbook/handbook-x86.xml?part=0&chap=0">Gentoo Linux Handbook</a>]</span></li></ul></article><article><h2>IBM T40 and multi-channel audio (ALSA)</h2><p>I'm finally getting around to setting up multi-channel audio. I've had this machine for awhile now, and most things are humming along.</p><p><em>References</em></p><ul><li><a href="http://opensrc.org/alsa/index.php?page=intel8x0">intel8&#215;0 – multichannel mixing</a> <span class=attribute>[<a href=http://opensrc.org>opensrc.org</a>]</span></li><li><a href="http://alsa.opensrc.org/index.php?page=DmixPlugin">dmix plugin</a> <span class=attribute>[<a href=http://alsa.opensrc.org>alsa.opensrc.org</a>]</span></li><li><a href=http://thread.gmane.org/gmane.linux.hardware.thinkpad/11358>T40 and ALSA, but no multichannel mixing</a> <span class=attribute>[thread on <a href=http://www.gmane.org>gmane.org</a>]</span></li></ul></article><article><h2>ACPI on IBM T40 with 2.6 kernel</h2><p>OK. getting ACPI to work properly needed to be revisited.</p><p><a href=http://bellet.info/laptop/t40.html#suspend_resume>Suspend/Resume on T40</a> <span class=attribute>[<a href=http://bellet.info/>bellet.info</a>]</span></p><p>This guy originally used APM, but his update on 2004/07/15 makes some good notes, which I followed, notably:</p><ul><li>Local APIC is required for USB to function properly, but it borks all over suspend/poweroff processing. There is a simple enough referenced patch to make it behave&#8230;</li></ul></article><article><h2>Gentoo on an IBM T40</h2><p>So, I have gentoo up and running on my T40, and thought I'd share the resources that helped me get there.</p><p>For those interested, here's the currently running kernel <a href=/files/config-2.6.7-gentoo-r11 title=2.6.7-gentoo-r11>config</a>.</p><p><em><strong>Preparation:</strong></em><br>I wiped the predesktop area. I don't plan on running windows, and I'd rather have the disk space, thanks.</p><p><em><strong>2.6 Kernel / Modules:</strong></em></p><ul><li><strong>Power Management</strong> – I stuck with <span class=caps>APM</span> rather than <span class=caps>ACPI</span>. I may try <span class=caps>ACPI</span> later, but not yet.</li><li><strong>Graphics Support</strong> – I went with framebuffer support this time, and so far, I like it.<br>Make sure you compile framebuffer console support <span class=caps>INTO</span> the kernel.</li><li><strong>Sound Support</strong> – Alsa + snd_i8&#215;0, as usual</li><li><strong>Networking</strong><ul><li>e1000 driver worked out of the box for the on-board Ethernet card</li><li><strong>There is a new <a href=http://ipw2100.sourceforge.net/>SF project</a> providing a driver for the onboard Intel Corp. <span class=caps>PRO</span>/Wireless <span class=caps>LAN</span> 2100 card.</strong> The driver seems to work fine, I've not been using it long enough to complain.. ;) Also, there is a <a href="http://forums.gentoo.org/viewtopic.php?t=122435&postdays=0&postorder=asc&start=1075&sid=f1d28c7b904951f6d8a4e4ac6368b5b6">nice ebuild</a> for centralizing wireless config. Sweet!<ul><li>emerge wireless-tools</li><li>emerge <a href="http://forums.gentoo.org/viewtopic.php?t=122435&postdays=0&postorder=asc&start=1075&sid=f1d28c7b904951f6d8a4e4ac6368b5b6">wireless-config</a></li><li>tweak /etc/conf.d/net and /etc/conf.d/wireless as recommended by wireless-config package<br>Noteable: associate_test_eth1="MAC" was required to allow dhcp to finish initializing. I also provided wireless dhcp settings in /etc/conf.d/wireless rather than in /etc/conf.d/net.</li><li>/etc/init.d/net.eth1 start</li></ul></li></ul></li></ul><pre><code>iwconfig  (before setting any wireless stuff up)
lo        no wireless extensions.
</code>
<code>eth0      no wireless extensions.
</code>
<code>eth1      IEEE 802.11b  ESSID:&quot;&quot;  Nickname:&quot;ipw2100&quot;
          Mode:Managed  Channel:1  Access Point: 00:00:00:00:00:00
          Bit Rate=0kb/s   Tx-Power=32 dBm
          Retry:on   RTS thr=2304 B   Fragment thr:off
          Encryption key:off
          Power Management:off
          Link Quality:0/100  Signal level:-66 dBm  Noise level:-98 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0
</code></pre><p><em><strong>lspci</strong></em></p><pre><code>0000:00:00.0 Host bridge: Intel Corp. 82855PM Processor to I/O Controller (rev 03)
0000:00:01.0 PCI bridge: Intel Corp. 82855PM Processor to AGP Controller (rev 03)
0000:00:1d.0 USB Controller: Intel Corp. 82801DB/DBL/DBM (ICH4/ICH4-L/ICH4-M) USB UHCI Controller #1 (rev 01)
0000:00:1d.1 USB Controller: Intel Corp. 82801DB/DBL/DBM (ICH4/ICH4-L/ICH4-M) USB UHCI Controller #2 (rev 01)
0000:00:1d.2 USB Controller: Intel Corp. 82801DB/DBL/DBM (ICH4/ICH4-L/ICH4-M) USB UHCI Controller #3 (rev 01)
0000:00:1d.7 USB Controller: Intel Corp. 82801DB/DBM (ICH4/ICH4-M) USB 2.0 EHCI Controller (rev 01)
0000:00:1e.0 PCI bridge: Intel Corp. 82801 PCI Bridge (rev 81)
0000:00:1f.0 ISA bridge: Intel Corp. 82801DBM LPC Interface Controller (rev 01)
0000:00:1f.1 IDE interface: Intel Corp. 82801DBM (ICH4) Ultra ATA Storage Controller (rev 01)
0000:00:1f.3 SMBus: Intel Corp. 82801DB/DBL/DBM (ICH4/ICH4-L/ICH4-M) SMBus Controller (rev 01)
0000:00:1f.5 Multimedia audio controller: Intel Corp. 82801DB/DBL/DBM (ICH4/ICH4-L/ICH4-M) AC&#39;97 Audio Controller (rev 01)
0000:00:1f.6 Modem: Intel Corp. 82801DB/DBL/DBM (ICH4/ICH4-L/ICH4-M) AC&#39;97 Modem Controller (rev 01)
0000:01:00.0 VGA compatible controller: ATI Technologies Inc Radeon R250 Lf [Radeon Mobility 9000 M9] (rev 02)
0000:02:00.0 CardBus bridge: Texas Instruments PCI1520 PC card Cardbus Controller (rev 01)
0000:02:00.1 CardBus bridge: Texas Instruments PCI1520 PC card Cardbus Controller (rev 01)
0000:02:01.0 Ethernet controller: Intel Corp. 82540EP Gigabit Ethernet Controller (Mobile) (rev 03)
0000:02:02.0 Network controller: Intel Corp. PRO/Wireless LAN 2100 3B Mini PCI Adapter (rev 04)
</code></pre><p><em><strong>References:</strong></em></p><ul><li><a href=http://www.cs.utexas.edu/users/walter/geek/linux-t40.html title="Walter Chang">Linux on the <span class=caps>IBM</span> Thinkpad T40</a></li><li><a href=http://www.ontheedge.ch/t40p.html>Gentoo linux on a Thinkpad T40p</a></li><li><a href=http://bellet.info/laptop/t40.html title="Fabrice Bellet">Linux on the Thinkpad T40</a></li><li><a href=http://www.enyo.de/fw/hardware/thinkpad/ title="Florian Weimer">Linux on the Thinkpad T40p</a> – <em>includes <span class=caps>ACPI</span> and Multihead X</em></li></ul><ul><li><a href=http://tpctl.sourceforge.net/>Thinkpad Configuration Tools for Linux</a></li><li><a href=http://news.gmane.org/gmane.linux.hardware.thinkpad>thinkpad-linux archives</a></li><li><a href=http://www.linux-on-laptops.com/ibm.html>linux-on-laptops: <span class=caps>IBM</span></a></li><li><a href=http://ipw2100.sourceforge.net/>Intel&#174; <span class=caps>PRO</span>/Wireless 2100 Driver for Linux</a></li><li><a href="http://forums.gentoo.org/viewtopic.php?t=122435&postdays=0&postorder=asc&start=1075&sid=f1d28c7b904951f6d8a4e4ac6368b5b6">wireless-config ebuild</a></li><li><a href=http://theorie.physik.uni-wuerzburg.de/~arwagner/computer/T41p/>Linux on <span class=caps>IBM</span> T41p</a></li></ul><p><em><strong>Other Notes:</strong></em></p><ul><li><a href=http://www.gentoo.org/doc/en/xorg-config.xml>Gentoo: The X Server Configuration <span class=caps>HOWTO</span></a></li><li><a href=http://www.gentoo.org/doc/en/alsa-guide.xml>Gentoo: Gentoo Linux <span class=caps>ALSA</span> Guide</a></li><li><a href=http://lists.debian.org/debian-laptop/2003/08/msg00120.html>console framebuffer [Solved]</a></li><li><a href=http://bluszcz.jabberpl.org/radeon_dri_howto.txt>radeon <span class=caps>DRI</span> howto</a></li><li><a href=http://gentoo-wiki.com/HOWTO_APM_Suspend>Gentoo: Howto <span class=caps>APM</span> Suspend</a></li><li><a href=http://freedesktop.org/~xorg/X11R6.7.0/doc/xorg.conf.5.html>X.org: xorg.conf (5) manpage</a></li><li><a href="http://forums.gentoo.org/viewtopic.php?t=175419">Gentoo Forums: Linux Memory Management or &#8216;Why is there no free <span class=caps>RAM</span>?'</a> – also, why you may not see some of your <span class=caps>RAM</span> (i.e. amounts over ~800M)</li><li><a href="{{site.baseurl}}{% link _posts/2004-01-20-linuxt23-dual-monitors.html %}/">T23 and Dual Monitors</a></li></ul><p><em><strong>X Font Server and X11:</strong></em></p><p>Finally, an email that concisely explains what the hell &#8216;unix:/7100' actually <span class=caps>DOES</span>&#8230;</p><p><a href=http://www.mail-archive.com/linux-il@cs.huji.ac.il/msg15131.html>X Font Problem</a></p><blockquote><p>From: Nadav Har'El</p><p>On Mon, Jul 09, 2001, Alexander V. Karelin wrote about
"Re: X font problem":<br>> 1. The unix/:-1 thing is very simple. unix stands for transport. / has to<br>> preceed the hostname. If the host is local, than the column follows the<br>> slash. And the last part is the number of the port, which for unix<br>> sockets, is -1. So – if You want to use Your font-server's resources – > first check which transport/port does it serve on. And than add it to the<br>> fontpath.</p><p>&#8230;</p><p>Anyway, what I'm trying to say is that -1 isn't exactly a port number, but<br>rather a hint the X server and/or font server use to find this file.<br>For example, in my Redhat 7.1 installation, I have in XF86CONFIG
FontPath &#8220;unix/:7100&#8221;</p><p>This 7100 is not a port number, since unix-domain sockets do not have<br>port numbers (an example where this would have been a port is with the<br>tcp transport: tcp/somecomputer.com:7100 – see man X(7) for more info).<br>This 7100 tells X to use the local file:<ol><li>ls -l /tmp/.font-unix/fs7100<br>srwxrwxrwx 1 xfs xfs 0 Jul 9 23:15 /tmp/.font-unix/fs7100</li></ol></p><p>Which the font server (xfs) is listening on. Note the &#8220;s&#8221; in the beggining<br>of the ls -l line: this says this is a special unix-domain *s*ocket file.</p></blockquote></article><article><h2>TOYS!</h2><p>I got a Sony Clie PEG-TJ37. I was thinking about the PEG-TJ55, but I just could NOT deal with the wheel thing in the back – too awkward.</p><p>Since the info on getting this puppy to work with linux seemed a little scattered, I figured I'd make my notes here, maybe someone else would find them handy, too.</p><p>Just as a side comment, syncing with jpilot worked oddly until I changed from devfs to udev (I left devfs in the kernel, but used the boot option to prevent it from being mounted). Once I switched to udev, behavior made much more sense.</p><p>linux distro: <code>gentoo</code><br>kernel version: <code>2.6.5-gentoo-r1 (gentoo-dev-sources)</code></p><p>kernel options:</p><pre><code>  CONFIG_USB=y
  CONFIG_USB_DEVICEFS=y
  CONFIG_USB_EHCI_HCD=m
  CONFIG_USB_UHCI_HCD=y
  CONFIG_USB_SERIAL=m
  CONFIG_USB_SERIAL_VISOR=m
</code></pre><p><em>References:</em></p><ul><li><a href=http://www.gentoo.org/doc/en/udev-guide.xml>Gentoo UDev Guide</a></li><li><a href=http://www.monkeynoodle.org/comp/clie-ms>Using a Clie's Memory Stick with Linux</a></li><li><a href=http://nick.kreucher.net/clie/survey-results.php>Sony Cli&#233;and Linux Survey Results</a>, <a href=http://nick.kreucher.net/clie/>Sony Cli &#233;and Linux</a></li><li><a href=http://pilot-link.org/README.usb>http://pilot-link.org/README.usb</a></li><li><a href=http://wiki.pilot-link.org/title/Palm+Device+Matrix>Palm Device Matrix – pilot-link Community Portal</a></li><li><a href=http://homepages.nildram.co.uk/~milnber/cliehowto.html>Sony Cli&#233; HOWTO</a></li><li><a href=http://news.gmane.org/gmane.comp.handhelds.clie.linux/>clie-linux mailing list archives</a></li><li><a href=http://www.geniusweb.com/LDP/HOWTO/Wireless-Sync-HOWTO/>Wireless Sync HOWTO</a></li><li><a href=http://www.nicholson.com/rhn/palm/pdb.txt>PDB Formats</a></li><li><a href=http://www.geocities.com/Heartland/Acres/3216/palmrecs.htm>Palm Desktop File Formats</a></li></ul></article><article><h2>2.6.3 Kernel on IBM T23</h2><p>Well, this is first pass, I'll record it anyway.</p><p><span class=caps>APM</span> doesn't work – suspend does strange things.</p><p>alsasound in the kernel works well – used mm-sources, and everything went smoothly. I don't remember any major issues.</p><p><a href=/files/config-2.6.3-rc1-mm1.txt>config-2.6.3-rc1-mm1</a></p><p>Notes on <span class=caps>APM</span> with 2.6 kernel:<br><a href=http://mailman.linux-thinkpad.org/pipermail/linux-thinkpad/2003-December/014828.html lang=ltp>T23 suspend – 2.6.0 final</a><br><a href=http://mailman.linux-thinkpad.org/pipermail/linux-thinkpad/2003-December/014832.html lang=ltp title=Alsa>T23 suspend – 2.6.0 final</a></p></article><article><h2>Linux/T23 - Dual Monitors</h2><p>Trying to get dual monitors working..</p><p><strong>References:</strong></p><ol><li><a href=http://www.spinics.net/lists/xf-xpert/msg04476.html><span class=caps>IBM</span> P70 Monitor Example</a></li><li><a href=http://www.enyo.de/fw/hardware/thinkpad/#3>Running <span class=caps>GNU</span>/Linux on the <span class=caps>IBM</span> ThinkPad T40p</a></li><li><a href=http://lists.samba.org/archive/linux/2002-January/001714.html>Sample .xsession</a></li><li><a href=http://thread.gmane.org/gmane.linux.hardware.thinkpad/7028 lang=ltp>Dual/MultiHead setup</a></li><li><a href=http://thread.gmane.org/gmane.linux.hardware.thinkpad/5615 lang=ltp>T40p+multihead</a></li></ol><p><strong>Update – 2004-01-22</strong></p><p>Well crap. All that research, and the Savage driver for the T23 just plain won't do dual display.</p><p>I'll have to wait for my upgrade..</p></article><article><h2>CDRW on IBM T23 with Gentoo</h2><p>Didn't notice until now that my CD-RW/DVD player wasn't loading properly – you can tell how much I use it, eh? <img alt=;-) src=/images/smilies/wink2.gif class=icon></p><p>I'd already built the kernel with the correct SCSI modules (see references, below). I'd also already added <code>"hdc=ide-scsi"</code> to my grub boot parameters.</p><p>What was left was the following:</p><p><code>/etc/devfsd.conf:</code></p><ol><li>uncommented:<pre><code># Give the cdrw group write permissions to /dev/sg0
# This is done to have non root user use the burner (scan the scsi bus)
REGISTER    ^scsi/host.*/bus.*/target.*/lun.*/generic PERMISSIONS root.cdrw 660</code></pre><li>commented out:<pre><code># Create /dev/cdrom for the first cdrom drive
#LOOKUP     ^cdrom$         CFUNCTION GLOBAL mksymlink cdroms/cdrom0 cdrom
#REGISTER   ^cdroms/cdrom0$ CFUNCTION GLOBAL mksymlink $devname cdrom
#UNREGISTER ^cdroms/cdrom0$ CFUNCTION GLOBAL unlink cdrom</code></pre><li>uncommented the following:<pre><code># Create /dev/cdrw for the first cdrom on the scsi bus
# (change &#8216;sr0' to suite your setup)
LOOKUP      ^cdrw$          CFUNCTION GLOBAL mksymlink sr0 cdrw
REGISTER    ^sr0$           CFUNCTION GLOBAL mksymlink $devname cdrw
UNREGISTER  ^sr0$           CFUNCTION GLOBAL unlink cdrw</code></pre></li></ol><p>Result:</p><pre><code># cdrecord -scanbus
Cdrecord 2.01a14 (i686-pc-linux-gnu) Copyright&#169; 1995-2003 Jörg Schilling
Linux sg driver version: 3.1.24
Using libscg version 'schily-0.7'
scsibus0:
    0,0,0  0) &#8216;MATSHITA' &#8216;UJDA720 DVD/CDRW' '1.03' Removable CD-ROM
    0,1,0  1) *
    0,2,0  2) *
    0,3,0  3) *
    0,4,0  4) *
    0,5,0  5) *
    0,6,0  6) *
    0,7,0  7) *
</code></pre><p>YAY! <img alt=:-) src=/images/smilies/grin.gif class=icon></p><p>References:</p><ul><li><a href=http://zeppox.ath.cx/~jackson/stuff/notes/gentoo_cdrw_notes.html>How to get a CD-RW and CDROM working using Gentoo</a></li></ol></li></ul></article><article><h2>Fixing Sound/Suspend-Resume on IBM T23 for Gentoo</h2><p><span class=caps>ALSA</span> does work, as I mentioned <a href="{{site.baseurl}}{% link _posts/2003-09-21-dammit-gentoo-on-t23-continued.html %}">here</a>, but it seems to have problems across a suspend-resume, i.e. it doesn't work post-resume.</p><p>Previously used patches don't seem to apply to newer Alsa modules.</p><p>Gentoo installs apmd_proxy in /etc/apm, with suspend.d and resume.d directories for handling special suspend/resume operations. Even better, event.d handles both.</p><p>So, based on some searching around, I ended up adding apmd to the list of services to start (<code>rc-update add apmd default</code>), and added the following script to get alsa to behave on resume:</p><blockquote><p><b><code>/etc/apm/event.d/alsa:</code></b><br><pre>#!/bin/sh

case &quot;$1&quot; in
resume)
    /usr/sbin/alsactl power off
    /usr/sbin/alsactl power on
    ;;
suspend|standby)
    ;;
esac </pre></p></blockquote><p>Found this lovely snippet that answers why <code>apm -s</code> works better than <code>Fn-F4</code> [emphasis added]:</p><blockquote><p>The <span class=caps>APM</span> <span class=caps>BIOS</span> rejects suspend (or hibernate) requests under certain conditions: e.g., on my TP600, when my Xircom Ethernet/modem card is inserted and the machine is on AC power. If I do <code>apm —suspend</code> then the kernel apm driver hears about the request first and tells apmd which runs apmd_proxy which runs the scripts in
<code>/etc/apm/event.d</code> which do things like eject the <span class=caps>PCMCIA</span> cards; only then does the apm driver pass the request on to the <span class=caps>BIOS</span>. (I think.) If I do <code>tpctl —suspend</code> on the other hand, the <span class=caps>BIOS</span> hears about the request first and, <em>if the <span class=caps>PCMCIA</span> card is still inserted, it rejects the request with a couple of beeps (high—-low).</em> <code>apm —suspend</code> is therefore to be preferred to <code>tpctl —suspend</code>.</p>Unfortunately, there is no alternative to
<code>tpctl —hibernate</code> : the apm program and the kernel apm driver don't know how to ask for hibernation. Solution: write a little script that does <code>cardctl eject ; tpctl —hib</code>. <code>Fn-F4</code> does the same as <code>tpctl —suspend</code> and <code>Fn-F12</code> does the same as <code>tpctl —hibernate</code>.</blockquote><p>The mention of the <span class=caps>BIOS</span> rejecting the suspend request when a <span class=caps>PCMCIA</span> card is inserted is exactly what I was seeing – I'm using my wireless card right now.</p><p>So after all that, I learned that I should suspend using <code>apm -s</code> and not with the thinkpad buttons if I have a pcmcia card active. With no <span class=caps>PCMCIA</span> card, the suspend request will be handled correctly by <span class=caps>APM</span> and apmd, and everything should be happy.</p><p><strong>References:</strong></p><ol><li><a href=http://www.linux-thinkpad.org/FAQ/cache/32.html>Why doesn't my Thinkpad hibernate? | Linux-ThinkPad <span class=caps>FAQ</span></a></li></ol><p>Various records of Linux Installation attempts:</p><ol><li><a href=http://www.loria.fr/~stuber/t30/debian-ibm-t30-2366-085.html>How to set up an <span class=caps>IBM</span> Thinkpad T30 Debian <span class=caps>GNU</span>/Linux</a></li><li><a href=http://www.open-organizations.org/view/Socialtools/LinuxOnThinkpadT23>Debian <span class=caps>GNU</span>/Linux on an <span class=caps>IBM</span> Thinkpad T23</a></li><li><a href=http://www.geocities.com/dirk_wetter/thinkpad/tp_suse8/index.html#s>Linux on A30p – Sound</a></li><li><a href=http://www.biplane.com.au/~kauer/miscellaneous/ibmt30-notes.html>SuSE Linux 8.0 on <span class=caps>IBM</span> T30 Thinkpad</a></li><li><a href=http://lists.debian.org/debian-devel/2000/debian-devel-200007/msg01108.html>Re: ThinkPad 600, kernel 2.2.17pre6, and hibernation</a></li><li><a href=http://mailman.linux-thinkpad.org/pipermail/linux-thinkpad/2001-March/004174.html lang=ltp><span class=caps>APMD</span> and Standby on the TP-T21</a></li><li><a href=http://article.gmane.org/gmane.linux.gentoo.user/35506 title="was Re: [gentoo-user] Laptop + Gentoo">artsshell permissions</a></li></ol><p>Older Alsa drivers:</p><ol><li><a href=http://www.alex.org.uk/T23/>Installing & Running Linux on an <span class=caps>IBM</span> T23 Laptop</a></li><li><a href=http://static.linuxcare.com/certs/intel8x0.diff>Patch to cards/card-intel8&#215;0.c for suspend/resume</a></li></ol><p>Information for Linux on <span class=caps>IBM</span> Laptops</p><ol><li><a href=http://www9.linuxcare.com/>LinuxCare</a> – <a href=http://www9.linuxcare.com/labs/certs/ibm/thinkpad/t23/><span class=caps>IBM</span> T23 certification</a></li><li><a href=http://www.linux-on-laptops.com/ibm.html>Linux on <span class=caps>IBM</span> Laptops</a></li><li><a href=http://www.linux-thinkpad.org/FAQ/>Linux-ThinkPad <span class=caps>FAQ</span></a></li></ol><p><span class=caps>APM</span> / Other tools</p><ol><li><a href=http://www.worldvisions.ca/~apenwarr/apmd/ title="Version 3.0.2">The Linux <span class=caps>APM</span> Daemon</a></li><li><a href=http://www.miketaylor.org.uk/tech/deb/>deb2targz</a></li></ol><p>Everywhere I looked, things would reference debian's <code>/etc/apm/event.d/alsa</code> script. Thing is, I don't run debian, and I'll be damned if I could find the contents of the script anywhere.</p><p>For future reference, I've attached the source <a href=/files/alsa>here</a>.</p></article><article><h2>It's Alive!! (Gentoo and T23)</h2><p>So a comment on the first of my entries about Gentoo on a T23 reminded me to make an update regarding my now working system...</p><p>I also sorted out my <a href="{{ site.baseurl }}{% link _posts/2003-09-22-gentoo-t23-and-vmware.html %}"><span class=caps>VMW</span>are issues</a>.</p><p><strong>Kernel Configuration</strong></p><p>Here is my <a href=/files/config-2.4.20-gentoo-r7.txt title=config-2.4.20-gentoo-r7>working kernel configuration</a></p><p>Significant points:<ul><li><span class=caps>APM</span> compiled in</li><li><span class=caps>ACPI</span> y, with sub-items as modules</li><li><span class=caps>PCMCIA</span>/Cardbus support compiled in (emerged pcmcia-cs with cardbus disabled)</li><li><span class=caps>IPSEC</span> as a module</li><li>Only the <span class=caps>EEPRO</span> module for <span class=caps>PCI</span> network support</li><li>Wireless <span class=caps>PCI</span> and Wireless <span class=caps>PCMCIA</span> and network <span class=caps>PCMCIA</span> support in modules</li><li>Only Sound support and <span class=caps>OSS</span> sound support, both as modules. Emerged alsa-driver for sound support.</li></ul></p><p><strong><span class=caps>VMW</span>are configuration</strong></p><p>This kind of sorted itself out. I spoke to a co-worker, and he said he hadn't had to do anything funny to get <span class=caps>VMW</span>are to stop complaining. So, I deleted /etc/devfs.d/vmware (a file I'd created to recreate the devfs link for vmmon), I removed vmnet and vmmon from /etc/modules.autoload.d/kernel-2.4 (I'd tried a few variations with the two modules here.. ).</p><p>I'd forgotten tweaking the <span class=caps>VMW</span>are start-up script to load the vmmon and vmnet modules. When I upgraded the <span class=caps>VMW</span>are-workstation ebuild (because of some minor change), etc-update reminded me, and I scrapped those changes to. For some reason, with absolutely no intervention on my part, <span class=caps>VMW</span>are now remains configured on it's own.</p><p>I probably thought it was having trouble because I was recompiling the kernel between reboots, something extremely unusual for me to do, but something that would cause the vmware modules to complain when they were loaded.</p><p><sighs></p><p>Everything is smashing, now!</p></article><article><h2>Gentoo, T23, and VMWare</h2><p><a href=http://lindows.prodigydigital.com/tutorials/vmware.html>Why do I have to run vmware-config.pl every time I reboot my computer?</a></p><p>This was happening to me, and while that's a lindows tutorial, it hit the nail on the head:</p><blockquote><p>Because devfs rebuilds the /dev tree at each reboot, it is likely that your vmnet and vmmon devices will become unavailable. Because those devices are now unavailable, you have to manually run the vmware-config.pl to rebuild them into the existing /dev tree.</p></blockquote><p><strong>[UPDATE: 9/29/2004]</strong> This is total hogwash, see <a href="{{ site.baseurl }}{% link _posts/2003-09-29-its-alive-gentoo-and-t23.html %}">here</a></p><p>So, I added the vmmon lines to devfs.d/vmware, which should start that part ok. The vmnet nodes are a bit more of a puzzle. One place says put a wrapper around init. I am not brave enough for that, and I'd rather work out the right stuff to have the nodes added by devfs when vmnet is referenced - that would make the most sense to me, anyway.</p><p>from devfsd man page:</p><blockquote><p><strong><span class=caps>RESTORE </span>directory</strong> This will restore entries previously saved under directory to devfs. Only symbolic links or entries with the sticky bit set will be restored. This action is taken as the configuration file is read. With appropriate <span class=caps>COPY </span>actions, complete persistence is acheived.</p></blockquote><p>Will have to look more at that tomorrow, I think that's the only way. getting that damn script to run is not something I want to try, but making a directory that has the vmnet entries in it for devfsd to restore makes more sense.</p><p><strong>yawn</strong></p><p>References:</p><ul><li><a href=http://www.atnf.csiro.au/people/rgooch/linux/docs/devfs.html><span class=caps>DEVFS </span>(Device File System) <span class=caps>FAQ</span></a></li><li><a href="http://wiki.sourcemage.org/index.php?page=HOWTO-devfsd+setup"><span class=caps>HOWTO</span>-devfsd</a></li><li><a href=http://www.gentoo.org/doc/en/rc-scripts.xml>Gentoo Linux 1.0 Init System</a></li><li><a href=http://www-106.ibm.com/developerworks/library/l-fs4.html title="Introduction to devfs">Common threads: Advanced filesystem implementor's guide, Part 4</a></li><li><a href=http://www-106.ibm.com/developerworks/library/l-fs5.html title="Setting up devfs">Common threads: Advanced filesystem implementor's guide, Part 5</a></li></ul></article><article><h2>Dammit- Gentoo on T23 continued</h2><p>So everything was working flawlessly, and I had to switch over into Mandrake to get something, and when I rebooted to Gentoo again, chaos reigned.</p><p>Well, not quite chaos, but several modules were refusing to load, with lots of scary messages about IRQ settings and other hogwash.</p><p>Actually, somehow, with building kernel modules for vmware and alsasound, it seems that module loading got completely hosed – it was trying to load e100, for example, which was a directory name.</p><p>So I edited my kernel config and removed dozens of modules for net, and usb and stuff that I didn't want anyway (i.e. ditched uhci.o in favor of usb_uhci.o, ditched the e100.o driver in favor of eepro100.o). Recreating all of the modules MINUS the alsa drivers helped.</p><p>I also installed the pcmcia-cs package with USE=&#8221;nocardbus&#8221; since PCMCIA and CardBus support are in the kernel.</p><p>After verifying that cleaned up the problem, I re-emerged the alsa-driver&#8230;<br>had to rmmod the sound drivers that had loaded themselves (so just soundcore remained), and restarted alsa, and that seemed happy.</p><p>Rebooted, and everythign is kaflooey again. Sheeiit.<br>Dammit, I'm an idjit. I mean really..</p><blockquote><p>rc-update del alsasound<br>rc-update add alsasound <strong>boot</strong></p></blockquote><p>That fixed it, I'd added alsasound as a default starter, which means the modules were being loaded by the autoload process.</p><p>And THEN, it's still borked&#8230;so I removed the extra sound module, i810_sound.o from the /lib/modules&#8230;. /kernel/sound path (where modules are installed, rebooted, and voila! no nastygrams. So, it looks like alsa and the audio drivers were fighting, and bringing a whole bunch o' extra junk into the match.</p><p>YEESH</p><p>References:</p><blockquote><p>gentoo bug <a href="http://bugs.gentoo.org/show_bug.cgi?id=23491">24391</a></p></blockquote></article><article><h2>Gentoo on a T23</h2><p>Audio: <a href=http://www.intel.com/support/graphics/linux/audio.htm>Intel i810</a>,<br>Alsa <a href="http://www.alsa-project.org/alsa-doc/doc-php/template.php3?company=Intel&card=i820&chip=i820&module=intel8x0">snd-intel8&#215;0</a></p><p>Video: <a href=http://www.probo.com/timr/savage40.html>S3 Savage IX</a> , <a href=http://www.dotfiles.com/files/13/311_XF86Config-T23.txt>Sample XF86Config</a></p><p>Just about everything: <span class=caps>IBM</span> 82801CAM <a href=ftp://download.intel.com/design/chipsets/datashts/29071601.pdf>chipsets</a></p><p><strong>Update: Sept 20, 2003</strong></p><p>First weird thing, I&#8217;m dual booting this machine right now, between my previous Mandrake install, and this new-fangled gentoo thing. And the System.Map generated by the gentoo system led to <span class=caps>REALLY</span> odd video behavior when I later went to build either version.. (now that I think about it, that was with the r6 kernel &#8211; should try the new System.map generated by the r7 kernel..) .. I relinked to the System.map used by Mandrake, and everything was happy &#8211; for either kernel.. whatever.</p><p>Found <a href=http://ghost.hn.org/~clesiuk/SonyVaio/#003>this link</a> &#8211; while it&#8217;s for a Sony Vaio, it&#8217;s also for the exact same intel do-everything chip that I&#8217;ve got in my T23. Some of the pieces, notably the <span class=caps>PCMCIA</span> and <span class=caps>APM</span> stuff, doesn&#8217;t apply to the T23.</p><p>Also <a href=http://www.patoche.org/alone/info/t23.html>this link for a T23 and Debian</a> which was the most helpful (<span class=caps>KISS</span> rule does seem to apply in this case).</p><p>**GAH!!!! *** I got network working, and I&#8217;ve no idea how.</p><p>I enabled <span class=caps>PCMCIA</span> and Cardbus support in the kernel, made <span class=caps>APM</span> a module, enabled <span class=caps>ACPI</span>, made sure the EEPRO100 and E100 drivers were built as modules, along with some of the Wireless <span class=caps>PCMCIA</span> drivers (I have an Orinoco Wireless <span class=caps>PCMCIA</span> card).</p><p>Also updated sys-apps/baselayout, and some other things from the CD version, perhaps some of those updates helped&#8230;</p></article><article><h2>Gentoooooooooooooooooooooo</h2><p>Jimminy Christmas!</p><p>Everything was paddling along smoothly until I hit this little hiccup, I've got an ATI RADEON card, which is apparently a whole pile of badness.</p><p>Thank goodness some punks have figured this crap out before me!</p><p>Gentoo Install (the chicken-shit I've never done this before way):</p><ol><li><p>Follow the <a href=http://gentoo.org/doc/en/gentoo-x86-install.xml>docs</a> till you're blue in the face, specifically:</p><ul><li><p>stage 3 install</p></li><li><p>get beginning packages from CD's saves some time</p></li><li><p>in <code>/etc/make.conf</code>, set some USE vars: <code>radeon gnome gtk2 -kde -qt mysql -ldap</code></p></li><li><p>timezone <code>EST5EDT</code></p></li><li><p>use genkernel for compile with caveat – I have a stupid radeon, so run genkernel-config, and turn agpgart on, but DRM off:</p><pre><code>Processor type and features—&gt;
&lt;*&gt; MTRR (Memory Type Range Register) support
Character devices—&gt;
&lt;*&gt; /dev/agpgart (AGP Support)
[*] all chipsets compiled into kernel (just to be safe)
[ ] Direct Rendering Manager (XFree86 DRI support)
</code></pre></li><li><p>continue with above instructions, get xfree-drm</p></li></ul></li><li><p>cancel the middle of an emerge only if you're ready to do some serious patchwork. Basically, don't start unless you're ready to finish.</p></li><li><p>not done yet, I'll let you know</p></li></ol><p>See <a href=http://www.gentoo.org/doc/en/dri-howto.xml>Hardware 3D Acceleration Guide</a>, which seems to be a more official version of
<a href="http://forums.gentoo.org/viewtopic.php?t=46681">Gentoo Forums :: View topic - Direct rendering (DRI) using XFree-DRM HOWTO</a></p></article></div><footer class=page-footer><div id=copyrights>&#169; 2002-2021 Erin Schnabel</div><div><a target=_blank href=https://github.com/ebullient title="ebullient on GitHub"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1664 896q0 251-146.5 451.5T1139 1625q-27 5-39.5-7t-12.5-30v-211q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105T1386 856q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27T578 459.5 492 446q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5T484 1274q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 89t.5 54q0 18-13 30t-40 7q-232-77-378.5-277.5T128 896q0-209 103-385.5T510.5 231 896 128t385.5 103T1561 510.5 1664 896z" fill="#fff"/></svg></a><a target=_blank href=https://twitter.com/ebullientworks title="Follow @ebullientworks"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5T1369.5 1125 1185 1335.5t-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5T285 1033q33 5 61 5 43 0 85-11-112-23-185.5-111.5T172 710v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5T884 653q-8-38-8-74 0-134 94.5-228.5T1199 256q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z" fill="#fff"/></svg></a><a target=_blank href=https://www.linkedin.com/in/erinschnabel/ title="Erin Schnabel on linked.in"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991H147V625h330zm21-306q1 73-50.5 122T312 490h-2q-82 0-132-49t-50-122q0-74 51.5-122.5T314 148t133 48.5T498 319zm1166 729v568h-329v-530q0-105-40.5-164.5T1168 862q-63 0-105.5 34.5T999 982q-11 30-11 81v553H659q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5T1285 602q171 0 275 113.5t104 332.5z" fill="#fff"/></svg></a><a target=_blank href=https://gameontext.org/slackin/ title="ebullient on gameontext.slack.com"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1583 776q62 0 103.5 40.5T1728 918q0 97-93 130l-172 59 56 167q7 21 7 47 0 59-42 102t-101 43q-47 0-85.5-27t-53.5-72l-55-165-310 106 55 164q8 24 8 47 0 59-42 102t-102 43q-47 0-85-27t-53-72l-55-163-153 53q-29 9-50 9-61 0-101.5-40T260 1323q0-47 27.5-85t71.5-53l156-53-105-313-156 54q-26 8-48 8-60 0-101-40.5T64 740q0-47 27.5-85t71.5-53l157-53-53-159q-8-24-8-47 0-60 42-102.5T403 198q47 0 85 27t53 72l54 160 310-105-54-160q-8-24-8-47 0-59 42.5-102T987 0q47 0 85.5 27.5T1126 99l53 161 162-55q21-6 43-6 60 0 102.5 39.5T1529 337q0 45-30 81.5t-74 51.5l-157 54 105 316 164-56q24-8 46-8zm-794 262 310-105-105-315-310 107z" fill="#fff"/></svg></a><a target=_blank href=https://pinboard.in/u:ebullient title=pinboard.in><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 25 25" enable-background="new 0 0 25 25"><polygon fill="#fff" points="13.908,14.85 9.211,19.547 9.961,15.412 3.571,7.706 0,7.894 7.895,0 7.895,3.007 15.412,9.773 20.111,8.647 15.227,13.721 25,24.436"/></svg></a><a target=_blank href=/index.xml title=Subscribe><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M576 1344q0 80-56 136t-136 56-136-56-56-136 56-136 136-56 136 56 56 136zm512 123q2 28-17 48-18 21-47 21H889q-25 0-43-16.5t-20-41.5q-22-229-184.5-391.5T250 902q-25-2-41.5-20T192 839V704q0-29 21-47 17-17 43-17h5q160 13 306 80.5T826 902q114 113 181.5 259t80.5 306zm512 2q2 27-18 47-18 20-46 20h-143q-26 0-44.5-17.5T1329 1476q-12-215-101-408.5t-231.5-336-336-231.5T252 398q-25-1-42.5-19.5T192 335V192q0-28 20-46 18-18 44-18h3q262 13 501.5 120T1186 542q187 186 294 425.5t120 501.5z" fill="#fff"/></svg></a></div></footer><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1146860-5','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>